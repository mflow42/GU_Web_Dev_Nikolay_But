"use strict";var _settingsComments,_createClass=function(){function a(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,s){return e&&a(t.prototype,e),s&&a(t,s),t}}();function _defineProperty(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var settingsCarousel={idCarousel:"carousel",carouselInnerClass:"carousel__inner",currentImageClass:"carousel__img",arrowPrevSpanClass:"carousel__inner_left-arrow",arrowNextSpanClass:"carousel__inner_right-arrow",arrowIconClass1:"fas",arrowPrevIconClass2:"fa-angle-left",arrowNextIconClass2:"fa-angle-right",imagesJSON:"json/carousel.json"},carousel={settingsCarousel:settingsCarousel,carouselEl:null,carouselInner:null,currentImg:null,images:[],currentImgSrc:null,currentImgIndex:0,init:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.settingsCarousel,t),this.carouselEl=document.querySelector("#"+this.settingsCarousel.idCarousel);var s=new XMLHttpRequest,a=this;s.open("GET",this.settingsCarousel.imagesJSON,!0),s.onload=function(){if(200===this.status){var t=JSON.parse(s.responseText);for(var e in t)a.images.push(t[e]);a.render()}},s.send()},render:function(){this.carouselInner=document.createElement("div"),this.carouselInner.classList.add(""+this.settingsCarousel.carouselInnerClass),this.carouselEl.append(this.carouselInner),this.currentImg=this.loadImage(),this.createArrowLeft(),this.createArrowRight()},getNextImage:function(){void 0===this.images[this.currentImgIndex+1]?this.currentImgIndex=0:this.currentImgIndex++,this.currentImg.src=this.images[this.currentImgIndex].src},getPrevImage:function(){void 0===this.images[this.currentImgIndex-1]?this.currentImgIndex=this.images.length-1:this.currentImgIndex--,this.currentImg.src=this.images[this.currentImgIndex].src},loadImage:function(){var t=document.createElement("img");return t.classList.add(this.settingsCarousel.currentImageClass),t.src=this.images[0].src,this.carouselInner.append(t),t},createArrowLeft:function(){var t=this,e=document.createElement("span");e.classList.add(this.settingsCarousel.arrowPrevSpanClass);var s=document.createElement("i");e.append(s),s.classList.add(this.settingsCarousel.arrowIconClass1),s.classList.add(this.settingsCarousel.arrowPrevIconClass2),e.addEventListener("click",function(){t.getPrevImage(t.currentImgIndex,t.images)}),this.carouselInner.append(e)},createArrowRight:function(){var t=this,e=document.createElement("span");e.classList.add(this.settingsCarousel.arrowNextSpanClass);var s=document.createElement("i");e.append(s),s.classList.add(this.settingsCarousel.arrowIconClass1),s.classList.add(this.settingsCarousel.arrowNextIconClass2),e.addEventListener("click",function(){t.getNextImage(t.currentImgIndex,t.images)}),this.carouselInner.append(e)}};window.addEventListener("load",function(){return carousel.init()});var settingsCart={cartElSelector:"cart",cartMobElSelector:"cart-mobile",cartIconSelector:"cart__icon",cartElemClass:"cart__items",cartImgClass:"cart__img",cartProdClass:"cart__prod",cartEmptyClass:"cart__empty",cartNameClass:"cart__name",cartStarsClass:"cart__stars",cartTotalClass:"cart__total",cartLineClass:"cart__line",cartBtnCloseClass:"cart__btn_close",cartTextPinkClass:"cart__text_pink",cartTextTechClass:"cart__text_tech",cartTextWrapperClass:"cart__text_wrapper",cartButtonCheckoutClassEnabled:"cart__btn_pink",cartButtonCheckoutClassDisabled:"cart__btn_disabled",cartButtonGoToCartClassEnabled:"cart__btn_grey",cartButtonDisabled:"cart__btn_disabled",itemInShopSelector:"product",itemsAddButtonSelector:"product__add",cartBadge:"cart__icon_badge"},cart={settingsCart:settingsCart,total:0,cartEl:null,cartContainer:null,cartMobEl:null,items:[],itemsInShop:[],cartBadge:null,init:function(){var s=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.settingsCart,t),this.items=[{id:"0001",imgPath:"img/cart-1.png",name:"REBOX ZANE1",rating:4,price:48,qty:1},{id:"0002",imgPath:"img/cart-2.png",name:"REBOX ZANE2",rating:4,price:49,qty:2}],this.cartEl=document.querySelector("#"+this.settingsCart.cartElSelector),this.cartMobEl=document.querySelector("#"+this.settingsCart.cartMobElSelector),this.itemsInShop=document.querySelectorAll("."+this.settingsCart.itemInShopSelector),this.cartBadge=document.querySelectorAll("."+this.settingsCart.cartBadge),document.body.addEventListener("click",function(t){var e;(e=t).target.closest("#cart")||"PATH"===e.srcElement.tagName.toUpperCase()||"svg"===e.srcElement.tagName||e.target.closest(".product__add")||(s.cartContainer.style.display="none")});var e=function(){"block"!==s.cartContainer.style.display&&(s.cartContainer.style.display="block",s.render())};this.cartEl.addEventListener("mouseenter",e),this.cartMobEl.addEventListener("mouseenter",e),this.createCartElem(this.cartEl,this.items),this.addToCartEvent(this.itemsInShop,this.items)},createCartElem:function(){this.cartContainer=document.createElement("div"),this.cartContainer.classList.add(this.settingsCart.cartElemClass),this.cartContainer.style.display,this.cartEl.append(this.cartContainer)},addToCartEvent:function(t,s){var a=this;t.forEach(function(e){e.querySelector("."+a.settingsCart.itemsAddButtonSelector).addEventListener("click",function(){a.items.some(function(t){return t.id===e.dataset.id&&(t.qty++,a.cartContainer.style.display="block",a.render()),t.id===e.dataset.id})||(s.push({id:e.dataset.id,imgPath:e.querySelector(".product__image").src,name:e.dataset.name,price:parseInt(e.dataset.price),qty:1,rating:e.dataset.rating}),a.cartContainer.style.display="block",a.render())})})},countTotal:function(){var s=this;(this.total=0)===this.items.length?this.total=0:this.items.forEach(function(t){var e=t.qty*t.price;s.total+=e})},makeTotalElem:function(){var t=document.createElement("div");t.classList.add(this.settingsCart.cartTotalClass);var e=document.createElement("span");e.textContent="TOTAL",t.append(e);var s=document.createElement("span"),a=document.createElement("span");a.textContent="$";var n=document.createElement("span");n.textContent=this.total.toFixed(2),s.append(a),s.append(n),t.append(s),this.cartContainer.append(t)},cartButtons:function(t){var e=document.createElement("a");e.classList.add(this.settingsCart.cartButtonCheckoutClassEnabled),"disabled"===t&&e.classList.add(this.settingsCart.cartButtonDisabled),e.textContent="checkout",e.href="checkout.html",this.cartContainer.append(e);var s=document.createElement("a");s.classList.add(this.settingsCart.cartButtonGoToCartClassEnabled),"disabled"===t&&s.classList.add(this.settingsCart.cartButtonDisabled),s.textContent="go to cart",s.href="shoppingcart.html",this.cartContainer.append(s)},removeFromCartEvent:function(s){var a=this;s.addEventListener("click",function(){a.items.forEach(function(t,e){t.id===s.dataset.id&&(a.items.splice(e,1),a.render())}),s.closest(".cart__prod").remove()})},render:function(){var u=this;if(this.cartContainer.innerHTML="",0<this.items.length)this.items.forEach(function(t){var e=document.createElement("div");e.classList.add(u.settingsCart.cartLineClass);var s=document.createElement("div");s.classList.add(u.settingsCart.cartProdClass);var a=document.createElement("img");a.src=t.imgPath,a.classList.add(u.settingsCart.cartImgClass),s.append(a);var n=document.createElement("p");n.classList.add(u.settingsCart.cartNameClass),n.textContent=t.name,s.append(n);var r=document.createElement("div");r.classList.add(u.settingsCart.cartStarsClass);for(var i=0;i<5;i++)i<t.rating?r.innerHTML+='<i class="fas fa-star cart__star"></i>':r.innerHTML+='<i class="far fa-star cart__star"></i>';s.append(r);var o=document.createElement("div");o.classList.add(u.settingsCart.cartTextWrapperClass);var c=document.createElement("p");c.textContent=t.qty,c.classList.add(u.settingsCart.cartTextPinkClass),o.append(c);var l=document.createElement("p");l.classList.add(u.settingsCart.cartTextTechClass),l.innerHTML+="&nbsp;&nbsp;x&nbsp;&nbsp;$",o.append(l),s.append(o);var d=document.createElement("p");d.classList.add(u.settingsCart.cartTextTechClass),d.textContent=t.price,o.append(d),s.append(o);var m=document.createElement("p");m.innerHTML+='<i class="fas fa-times-circle"></i>',m.classList.add(u.settingsCart.cartBtnCloseClass),m.dataset.id=t.id,u.removeFromCartEvent(m),s.append(m),u.cartContainer.append(s),u.cartContainer.append(e)}),this.countTotal(),this.makeTotalElem(),this.cartButtons("enabled");else{var t=document.createElement("div");t.classList.add(this.settingsCart.cartProdClass),t.classList.add(this.settingsCart.cartEmptyClass),t.style.textAlign="center",t.style.verticalAlign="center",t.textContent="Your cart is empty",this.cartContainer.append(t),this.cartButtons("disabled")}}};window.addEventListener("load",function(){return cart.init()});var Comment=function(){function c(t,e,s,a,n,r,i,o){_classCallCheck(this,c),this.id_comment=t,this.text=e,this.approved=s,this.classContainer=a,this.classContainerApproved=n,this.classMessage=r,this.classDelBtn=i,this.classApprovelBtn=o}return _createClass(c,[{key:"render",value:function(t){var e=document.createElement("div");e.classList.add(this.classContainer),e.dataset.id=this.id_comment,e.dataset.approved=this.approved;var s=document.createElement("p");s.classList.add(this.classMessage),s.textContent=this.text;var a=document.createElement("button");a.classList.add(this.classApprovelBtn),a.dataset.id=this.id_comment,a.dataset.type="approve",a.textContent="approve";var n=document.createElement("button");n.classList.add(this.classDelBtn),n.dataset.id=this.id_comment,n.dataset.type="delete",n.textContent="delete",e.append(s),"true"===e.dataset.approved?e.classList.add(this.classContainerApproved):"false"===e.dataset.approved&&e.append(a),e.append(n),t.append(e)}}]),c}(),settingsComments=(_defineProperty(_settingsComments={idContainer:"comments",classCommentApproved:"approved",urlGetAllComments:"json/comment.list.json",urlDelComment:"json/comment.delete.json",urlApprovalComment:"json/comment.submit.json",urlAddComment:"json/comment.add.json",classForm:"comments__form",classTextarea:"comments__textarea",classErrorTextarea:"error_textarea",classErrorText:"error_text",commentRegexp:".",classFormSubmitBtn:"__submit",classComment:"__comment"},"classCommentApproved","approved"),_defineProperty(_settingsComments,"classMessage","__message"),_defineProperty(_settingsComments,"classBtnDelete","__btn_delete"),_defineProperty(_settingsComments,"classBtnApprove","__btn_approve"),_settingsComments),comments={settingsComments:settingsComments,commentEl:null,comments:[],textAreaEl:null,formEl:null,init:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.settingsComments,t),this.commentEl=document.querySelector("#"+settingsComments.idContainer),this.commentEl.addEventListener("click",this.btnClickHandler.bind(this));var e=new XMLHttpRequest,s=this;e.open("GET",this.settingsComments.urlGetAllComments,!0),e.onload=function(){200===this.status&&(JSON.parse(this.responseText).comments.forEach(function(t){s.comments.push(t)}),s.render(s.commentEl,s.comments,s.settingsComments))},e.send()},btnClickHandler:function(t){"delete"===t.target.dataset.type?this.delete(t.target):"approve"===t.target.dataset.type?this.approve(t.target):"add"===t.target.dataset.type&&(t.preventDefault(),this.add(t.target))},approve:function(e){var s=this,t=new XMLHttpRequest;t.open("GET",s.settingsComments.urlApprovalComment,!0),t.onload=function(){if(200===this.status){var t=e.closest("."+s.settingsComments.idContainer+s.settingsComments.classComment);t.classList.add(s.settingsComments.classCommentApproved),t.dataset.approved=!0,e.remove()}},t.send()},delete:function(s){var a=this,t=new XMLHttpRequest;t.open("GET",a.settingsComments.urlDelComment,!0),t.onload=function(){if(200===this.status){var e=s.closest(".comments__comment"),t=a.comments.findIndex(function(t){return t.id_comment===parseInt(e.dataset.id)});a.comments.splice(t,1),a.render(a.commentEl,a.comments,a.settingsComments)}},t.send()},makeForm:function(){var r=this,t=document.createElement("form");t.classList.add(this.settingsComments.classForm),t.name="commentForm",t.id="commentFormId",t.method="GET",t.action="#";(this.formEl=t).addEventListener("submit",function(t){var e,s;if(t.preventDefault(),e=r.textAreaEl,s=r.settingsComments.commentRegexp,!new RegExp(""+s,"gi").test(e.value))return function(t){if(!t.parentElement.querySelector("."+r.settingsComments.classErrorText)){t.classList.add(r.settingsComments.classErrorTextarea);var e=document.createElement("span");e.textContent="Text must contain at least 1 character",e.classList.add(r.settingsComments.classErrorText),t.parentElement.append(e)}}(r.textAreaEl);var a=r,n=new XMLHttpRequest;n.open("GET",a.settingsComments.urlAddComment,!0),n.onload=function(){200===this.status&&(console.log(JSON.parse(this.response)),a.comments.push({id_comment:Date.now(),text:a.textAreaEl.value}),a.render(a.commentEl,a.comments,a.settingsComments))},n.send()});var e=document.createElement("h3");e.classList.add(this.settingsComments.classFormTitle),e.textContent="Add comment:";var s=document.createElement("label");s.for="commentFormName",s.textContent="input here and click 'submit' button";var a=document.createElement("textarea");a.name="commentFormName",a.classList.add(this.settingsComments.classTextarea);!function(t,e){t.rows=e;t.addEventListener("input",function(){var t=this.value.split("\n").length;t<=e||e<t&&(this.rows=t)})}(this.textAreaEl=a,5);var n=document.createElement("button");n.classList.add(""+this.settingsComments.idContainer+this.settingsComments.classFormSubmitBtn),n.textContent="Submit comment",t.append(e),t.append(s),t.append(a),t.append(n),this.commentEl.append(t)},render:function(t,e,s){if(t.innerHTML="",0<e.length){var a=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var c=i.value;new Comment(c.id_comment,c.text,c.approved,""+s.idContainer+s.classComment,""+s.classCommentApproved,""+s.idContainer+s.classMessage,""+s.idContainer+s.classBtnDelete,""+s.idContainer+s.classBtnApprove).render(t)}}catch(t){n=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw r}}}this.makeForm()}};window.addEventListener("load",function(){return comments.init()});var Product=function(){function r(t,e,s,a,n){_classCallCheck(this,r)}return _createClass(r,[{key:"render",value:function(t){var e=document.createElement("div");e.classList.add(this.classContainer),e.dataset.id=this.id_comment,e.dataset.approved=this.approved;var s=document.createElement("p");s.classList.add(this.classMessage),s.textContent=this.text;var a=document.createElement("button");a.classList.add(this.classApprovelBtn),a.dataset.id=this.id_comment,a.dataset.type="approve",a.textContent="approve";var n=document.createElement("button");n.classList.add(this.classDelBtn),n.dataset.id=this.id_comment,n.dataset.type="delete",n.textContent="delete",e.append(s),"true"===e.dataset.approved?e.classList.add(this.classContainerApproved):"false"===e.dataset.approved&&e.append(a),e.append(n),t.append(e)}}]),r}();